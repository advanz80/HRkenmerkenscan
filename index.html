<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Competentie Assessment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4F46E5;
            --primary-light: #818CF8;
            --primary-dark: #3730A3;
            --secondary: #10B981;
            --bg: #F8FAFC;
            --card-bg: #FFFFFF;
            --text: #1E293B;
            --text-light: #64748B;
            --border: #E2E8F0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 16px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            padding: 16px 0;
        }

        .header h1 {
            font-size: 1.4rem;
            color: var(--primary);
        }

        .progress-container {
            background: var(--border);
            border-radius: 10px;
            height: 8px;
            margin: 16px 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            height: 100%;
            border-radius: 10px;
            transition: width 0.4s ease;
        }

        .progress-text {
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 16px;
        }

        .screen {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 28px;
            box-shadow: var(--shadow-lg);
        }

        .card h2 {
            font-size: 1.5rem;
            margin-bottom: 12px;
            color: var(--primary);
        }

        .card p {
            color: var(--text-light);
            margin-bottom: 16px;
        }

        .intro-card {
            text-align: center;
        }

        .intro-info {
            background: var(--bg);
            border-radius: 12px;
            padding: 20px;
            margin: 24px 0;
            text-align: left;
        }

        .intro-info h4 {
            color: var(--text);
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .intro-info ul {
            list-style: none;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .intro-info li {
            padding: 6px 0;
            padding-left: 20px;
            position: relative;
        }

        .intro-info li::before {
            content: "•";
            color: var(--primary);
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 16px 36px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 14px rgba(79, 70, 229, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.5);
        }

        .btn-secondary {
            background: var(--card-bg);
            color: var(--primary);
            border: 2px solid var(--border);
        }

        .btn-icon {
            width: 48px;
            height: 48px;
            padding: 0;
            border-radius: 12px;
        }

        /* Question styling */
        .question-card {
            padding: 24px;
        }

        .question-number {
            display: inline-block;
            background: var(--primary);
            color: white;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 6px 14px;
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .statement-text {
            font-size: 1.15rem;
            color: var(--text);
            margin-bottom: 28px;
            font-weight: 500;
            text-align: center;
            line-height: 1.5;
            min-height: 60px;
        }

        /* Likert scale */
        .likert-container {
            margin-top: 20px;
        }

        .likert-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .likert-scale {
            display: flex;
            justify-content: space-between;
            gap: 8px;
        }

        .likert-option {
            flex: 1;
            aspect-ratio: 1;
            max-width: 60px;
            border: 3px solid var(--border);
            border-radius: 12px;
            background: var(--bg);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text-light);
        }

        .likert-option:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .likert-option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .likert-option.selected-1 { background: #EF4444; border-color: #EF4444; }
        .likert-option.selected-2 { background: #F97316; border-color: #F97316; }
        .likert-option.selected-3 { background: #EAB308; border-color: #EAB308; }
        .likert-option.selected-4 { background: #22C55E; border-color: #22C55E; }
        .likert-option.selected-5 { background: #10B981; border-color: #10B981; }

        .likert-sublabels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.75rem;
            color: var(--text-light);
        }

        .nav-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .nav-buttons .btn {
            flex: 1;
        }

        /* Processing */
        .processing-card {
            text-align: center;
            padding: 48px 28px;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 24px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Results */
        .results-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .results-header h2 {
            font-size: 1.4rem;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .result-item {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .result-rank {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            color: white;
            flex-shrink: 0;
        }

        .result-item:nth-child(1) .result-rank { background: linear-gradient(135deg, #FFD700, #FFA500); color: #333; }
        .result-item:nth-child(2) .result-rank { background: linear-gradient(135deg, #94A3B8, #64748B); }
        .result-item:nth-child(3) .result-rank { background: linear-gradient(135deg, #CD7F32, #8B4513); }
        .result-item:nth-child(4) .result-rank { background: var(--secondary); }
        .result-item:nth-child(5) .result-rank { background: var(--primary); }

        .result-name {
            font-size: 1.05rem;
            font-weight: 700;
            color: var(--text);
            flex-grow: 1;
        }

        .result-score {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
            background: rgba(79, 70, 229, 0.1);
            padding: 4px 12px;
            border-radius: 12px;
        }

        .score-bar-container {
            background: var(--border);
            border-radius: 6px;
            height: 8px;
            margin-bottom: 12px;
            overflow: hidden;
        }

        .score-bar {
            height: 100%;
            border-radius: 6px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.6s ease;
        }

        .result-description {
            font-size: 0.9rem;
            color: var(--text-light);
            line-height: 1.5;
        }

        /* Full results toggle */
        .show-all-btn {
            width: 100%;
            margin-top: 16px;
            padding: 14px;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-light);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .show-all-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .all-results {
            display: none;
            margin-top: 16px;
        }

        .all-results.show {
            display: block;
        }

        .all-results .result-item {
            opacity: 0.85;
        }

        .all-results .result-rank {
            background: var(--text-light);
        }

        /* Share section */
        .share-section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .share-section h4 {
            margin-bottom: 12px;
            color: var(--text);
            font-size: 0.95rem;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .btn-share {
            padding: 10px 18px;
            font-size: 0.85rem;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--text);
            color: white;
            padding: 12px 24px;
            border-radius: 10px;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* Score interpretation legend */
        .score-legend {
            background: var(--bg);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            font-size: 0.85rem;
        }

        .score-legend h4 {
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-dot.high { background: #10B981; }
        .legend-dot.medium { background: #EAB308; }
        .legend-dot.low { background: #EF4444; }

        @media (max-width: 480px) {
            .container { padding: 12px; }
            .card { padding: 20px; }
            .statement-text { font-size: 1.05rem; }
            .likert-option { max-width: 50px; font-size: 1rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Competentie Assessment</h1>
        </header>

        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-text" id="progressText" style="display: none;"></div>

        <!-- Intro -->
        <div class="screen active" id="introScreen">
            <div class="card intro-card">
                <h2>Ontdek Je Competenties</h2>
                <p>Deze assessment meet 11 belangrijke competenties op basis van gedragsstellingen.</p>

                <div class="intro-info">
                    <h4>Hoe werkt het?</h4>
                    <ul>
                        <li>Je krijgt 44 stellingen over werkgedrag te zien</li>
                        <li>Geef aan in hoeverre elke stelling op jou van toepassing is</li>
                        <li>Elke competentie wordt onafhankelijk gemeten</li>
                        <li>De test duurt ongeveer 8-10 minuten</li>
                    </ul>
                </div>

                <div class="intro-info">
                    <h4>Gemeten competenties</h4>
                    <ul>
                        <li>Ondernemerschap</li>
                        <li>Visie & Strategisch denken</li>
                        <li>Analytisch vermogen</li>
                        <li>Economische besluitvaardigheid</li>
                        <li>Sensitiviteit</li>
                        <li>Aanpassingsvermogen</li>
                        <li>Intrinsieke motivatie</li>
                        <li>Samenwerken</li>
                        <li>Zelfeffectiviteit</li>
                        <li>Proactiviteit</li>
                        <li>Resultaatgerichtheid</li>
                    </ul>
                </div>

                <p style="font-size: 0.85rem; margin-top: 20px;">
                    Tip: Beantwoord op basis van hoe je daadwerkelijk bent, niet hoe je zou willen zijn.
                </p>

                <button class="btn btn-primary" onclick="startAssessment()" style="margin-top: 20px;">
                    Start Assessment
                </button>
            </div>
        </div>

        <!-- Question -->
        <div class="screen" id="questionScreen">
            <div class="card question-card">
                <div class="question-number" id="questionNumber">Vraag 1 van 44</div>
                <p class="statement-text" id="statementText"></p>

                <div class="likert-container">
                    <div class="likert-labels">
                        <span>Helemaal niet</span>
                        <span>Helemaal wel</span>
                    </div>
                    <div class="likert-scale" id="likertScale">
                        <div class="likert-option" onclick="selectAnswer(1)">1</div>
                        <div class="likert-option" onclick="selectAnswer(2)">2</div>
                        <div class="likert-option" onclick="selectAnswer(3)">3</div>
                        <div class="likert-option" onclick="selectAnswer(4)">4</div>
                        <div class="likert-option" onclick="selectAnswer(5)">5</div>
                    </div>
                    <div class="likert-sublabels">
                        <span>Niet van toepassing</span>
                        <span>Volledig van toepassing</span>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-secondary btn-icon" id="prevBtn" onclick="previousQuestion()">←</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Volgende</button>
            </div>
        </div>

        <!-- Processing -->
        <div class="screen" id="processingScreen">
            <div class="card processing-card">
                <div class="spinner"></div>
                <h2>Resultaten berekenen...</h2>
                <p>Je antwoorden worden geanalyseerd</p>
            </div>
        </div>

        <!-- Results -->
        <div class="screen" id="resultsScreen">
            <div class="results-header">
                <h2>Jouw Competentie Profiel</h2>
                <p style="color: var(--text-light); font-size: 0.9rem;">Gerangschikt op basis van jouw scores</p>
            </div>

            <div class="score-legend">
                <h4>Score interpretatie</h4>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-dot high"></div>
                        <span>70-100%: Sterk ontwikkeld</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot medium"></div>
                        <span>40-69%: Gemiddeld</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot low"></div>
                        <span>0-39%: Ontwikkelpunt</span>
                    </div>
                </div>
            </div>

            <div id="topResults"></div>

            <button class="show-all-btn" id="showAllBtn" onclick="toggleAllResults()">
                Toon alle 11 competenties
            </button>

            <div class="all-results" id="allResults"></div>

            <div class="share-section">
                <h4>Bewaar je resultaten</h4>
                <div class="share-buttons">
                    <button class="btn btn-secondary btn-share" onclick="copyResults()">Kopieer</button>
                    <button class="btn btn-secondary btn-share" onclick="downloadResults()">Download</button>
                </div>
            </div>

            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-primary" onclick="restartAssessment()">Opnieuw</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // 11 competenties met definities
        const competencies = {
            ondernemerschap: {
                name: "Ondernemerschap",
                definition: "Kansen signaleren en benutten, en risico durven nemen om doelen te bereiken.",
                behavior: "Ziet commerciële mogelijkheden, neemt initiatief voor nieuwe projecten, durft berekende risico's te nemen."
            },
            visie: {
                name: "Visie & Strategisch denken",
                definition: "De lange termijn kunnen overzien en richting bepalen voor jezelf en anderen.",
                behavior: "Denkt vooruit, ziet het grote geheel, verbindt dagelijkse acties aan langetermijndoelen."
            },
            intelligentie: {
                name: "Analytisch vermogen",
                definition: "Logisch kunnen redeneren en nieuwe, complexe problemen effectief oplossen.",
                behavior: "Analyseert informatie snel, legt verbanden, komt tot onderbouwde conclusies."
            },
            besluitvaardigheid: {
                name: "Economische besluitvaardigheid",
                definition: "Onderbouwde keuzes maken met oog voor middelen, belangen en impact.",
                behavior: "Weegt kosten en baten af, neemt tijdig beslissingen, houdt rekening met consequenties."
            },
            sensitiviteit: {
                name: "Sensitiviteit",
                definition: "Oog hebben voor gevoelens en behoeften van anderen en daar rekening mee houden.",
                behavior: "Pikt signalen op, toont empathie, stemt gedrag af op wat anderen nodig hebben."
            },
            aanpassingsvermogen: {
                name: "Aanpassingsvermogen",
                definition: "Flexibel omgaan met verandering en effectief blijven in wisselende omstandigheden.",
                behavior: "Past aanpak aan, blijft kalm bij onverwachte wendingen, ziet verandering als kans."
            },
            motivatie: {
                name: "Intrinsieke motivatie",
                definition: "Gedrevenheid vanuit persoonlijke waarden en zingeving, niet alleen externe beloningen.",
                behavior: "Werkt met passie, zoekt betekenis, blijft gemotiveerd zonder directe beloning."
            },
            samenwerken: {
                name: "Samenwerken",
                definition: "Constructief bijdragen aan teamresultaat en effectief werken met anderen.",
                behavior: "Deelt kennis, ondersteunt collega's, stelt teambelang soms boven eigenbelang."
            },
            zelfeffectiviteit: {
                name: "Zelfeffectiviteit",
                definition: "Vertrouwen in eigen bekwaamheid om uitdagingen aan te kunnen.",
                behavior: "Gaat uitdagingen aan, gelooft in eigen kunnen, herstelt snel van tegenslagen."
            },
            proactiviteit: {
                name: "Proactiviteit",
                definition: "Zelf kansen zien en handelen zonder af te wachten tot anderen initiatief nemen.",
                behavior: "Neemt initiatief, anticipeert op problemen, wacht niet op instructies."
            },
            resultaatgerichtheid: {
                name: "Resultaatgerichtheid",
                definition: "Focus op het behalen van meetbare resultaten en concrete doelstellingen.",
                behavior: "Stelt duidelijke doelen, bewaakt voortgang, laat zich niet afleiden van het einddoel."
            }
        };

        // 44 gedragsstellingen - 4 per competentie
        // Per competentie: 2 positief geformuleerd, 2 negatief (reverse) geformuleerd
        // reverse: true betekent dat de score omgekeerd moet worden (1→5, 2→4, etc.)
        const statements = [
            // Ondernemerschap (4 stellingen)
            { text: "Ik zie regelmatig kansen die anderen over het hoofd zien", comp: "ondernemerschap", reverse: false },
            { text: "Ik durf risico's te nemen als de potentiële opbrengst groot is", comp: "ondernemerschap", reverse: false },
            { text: "Ik vermijd liever risico's, ook als er kansen liggen", comp: "ondernemerschap", reverse: true },
            { text: "Ik wacht liever af tot anderen het voortouw nemen bij nieuwe initiatieven", comp: "ondernemerschap", reverse: true },

            // Visie & Strategisch denken (4 stellingen)
            { text: "Ik denk vaak na over waar we over 5 jaar willen staan", comp: "visie", reverse: false },
            { text: "Ik verbind dagelijkse taken aan grotere, strategische doelen", comp: "visie", reverse: false },
            { text: "Ik focus me vooral op wat er vandaag moet gebeuren, niet op de lange termijn", comp: "visie", reverse: true },
            { text: "Het valt me moeilijk om het grote geheel te overzien", comp: "visie", reverse: true },

            // Analytisch vermogen (4 stellingen)
            { text: "Ik kan nieuwe, complexe informatie snel doorgronden", comp: "intelligentie", reverse: false },
            { text: "Ik zie snel patronen en verbanden in complexe situaties", comp: "intelligentie", reverse: false },
            { text: "Ik vind het lastig om logisch te redeneren bij ingewikkelde vraagstukken", comp: "intelligentie", reverse: true },
            { text: "Ik heb moeite met het analyseren van grote hoeveelheden informatie", comp: "intelligentie", reverse: true },

            // Economische besluitvaardigheid (4 stellingen)
            { text: "Ik weeg kosten en baten zorgvuldig af voordat ik beslis", comp: "besluitvaardigheid", reverse: false },
            { text: "Ik neem tijdig beslissingen, ook als niet alle informatie beschikbaar is", comp: "besluitvaardigheid", reverse: false },
            { text: "Ik stel beslissingen vaak uit omdat ik meer zekerheid wil", comp: "besluitvaardigheid", reverse: true },
            { text: "Ik vergeet regelmatig de financiële consequenties mee te wegen", comp: "besluitvaardigheid", reverse: true },

            // Sensitiviteit (4 stellingen)
            { text: "Ik merk snel wat anderen voelen of nodig hebben", comp: "sensitiviteit", reverse: false },
            { text: "Ik stem mijn communicatie af op wat de ander nodig heeft", comp: "sensitiviteit", reverse: false },
            { text: "Ik heb moeite om subtiele emotionele signalen op te pikken", comp: "sensitiviteit", reverse: true },
            { text: "Ik vergeet soms rekening te houden met hoe anderen zich voelen", comp: "sensitiviteit", reverse: true },

            // Aanpassingsvermogen (4 stellingen)
            { text: "Ik zie verandering als een kans, niet als een bedreiging", comp: "aanpassingsvermogen", reverse: false },
            { text: "Ik blijf kalm en effectief als plannen plotseling veranderen", comp: "aanpassingsvermogen", reverse: false },
            { text: "Ik heb moeite met onverwachte veranderingen in mijn werk", comp: "aanpassingsvermogen", reverse: true },
            { text: "Ik voel me ongemakkelijk als ik mijn aanpak moet aanpassen", comp: "aanpassingsvermogen", reverse: true },

            // Intrinsieke motivatie (4 stellingen)
            { text: "Ik werk het hardst aan taken die ik persoonlijk waardevol vind", comp: "motivatie", reverse: false },
            { text: "Ik blijf gemotiveerd ook zonder externe beloningen of erkenning", comp: "motivatie", reverse: false },
            { text: "Ik heb externe prikkels nodig om gemotiveerd te blijven", comp: "motivatie", reverse: true },
            { text: "Ik doe mijn werk vooral voor het salaris en de zekerheid", comp: "motivatie", reverse: true },

            // Samenwerken (4 stellingen)
            { text: "Ik help collega's graag om samen een beter resultaat te bereiken", comp: "samenwerken", reverse: false },
            { text: "Ik stel het teambelang soms boven mijn eigen belang", comp: "samenwerken", reverse: false },
            { text: "Ik werk liever alleen dan in een team", comp: "samenwerken", reverse: true },
            { text: "Ik vind het lastig om kennis en informatie te delen met anderen", comp: "samenwerken", reverse: true },

            // Zelfeffectiviteit (4 stellingen)
            { text: "Ik ga nieuwe uitdagingen met vertrouwen tegemoet", comp: "zelfeffectiviteit", reverse: false },
            { text: "Ik herstel snel als iets niet lukt en probeer het opnieuw", comp: "zelfeffectiviteit", reverse: false },
            { text: "Ik twijfel vaak aan mijn eigen kunnen bij moeilijke taken", comp: "zelfeffectiviteit", reverse: true },
            { text: "Tegenslagen hebben lang invloed op mijn zelfvertrouwen", comp: "zelfeffectiviteit", reverse: true },

            // Proactiviteit (4 stellingen)
            { text: "Ik wacht niet af, maar onderneem zelf actie", comp: "proactiviteit", reverse: false },
            { text: "Ik signaleer problemen voordat ze urgent worden", comp: "proactiviteit", reverse: false },
            { text: "Ik wacht meestal op instructies voordat ik aan de slag ga", comp: "proactiviteit", reverse: true },
            { text: "Ik reageer vooral op problemen in plaats van ze te voorkomen", comp: "proactiviteit", reverse: true },

            // Resultaatgerichtheid (4 stellingen)
            { text: "Ik stel duidelijke, meetbare doelen voor mezelf", comp: "resultaatgerichtheid", reverse: false },
            { text: "Ik laat me niet afleiden van het behalen van mijn doelen", comp: "resultaatgerichtheid", reverse: false },
            { text: "Ik raak soms de focus kwijt en vergeet mijn oorspronkelijke doel", comp: "resultaatgerichtheid", reverse: true },
            { text: "Het stellen van concrete doelen vind ik niet zo belangrijk", comp: "resultaatgerichtheid", reverse: true }
        ];

        // State
        let currentQuestion = 0;
        let answers = [];
        let shuffledStatements = [];

        function shuffleArray(arr) {
            const shuffled = [...arr];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startAssessment() {
            // Shuffle statements for randomization
            shuffledStatements = shuffleArray(statements);
            answers = new Array(shuffledStatements.length).fill(null);
            currentQuestion = 0;

            document.getElementById('introScreen').classList.remove('active');
            document.getElementById('questionScreen').classList.add('active');
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('progressText').style.display = 'block';

            renderQuestion();
        }

        function renderQuestion() {
            const statement = shuffledStatements[currentQuestion];

            document.getElementById('questionNumber').textContent =
                `Vraag ${currentQuestion + 1} van ${shuffledStatements.length}`;

            const progress = (currentQuestion / shuffledStatements.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${Math.round(progress)}% voltooid`;

            document.getElementById('statementText').textContent = statement.text;

            // Reset and update likert scale
            const options = document.querySelectorAll('.likert-option');
            options.forEach(opt => {
                opt.className = 'likert-option';
            });

            if (answers[currentQuestion] !== null) {
                const selectedValue = answers[currentQuestion];
                options[selectedValue - 1].classList.add('selected', `selected-${selectedValue}`);
            }

            document.getElementById('prevBtn').style.visibility =
                currentQuestion === 0 ? 'hidden' : 'visible';

            document.getElementById('nextBtn').disabled = answers[currentQuestion] === null;
            document.getElementById('nextBtn').textContent =
                currentQuestion === shuffledStatements.length - 1 ? 'Resultaten' : 'Volgende';
        }

        function selectAnswer(value) {
            answers[currentQuestion] = value;

            // Update visual selection
            const options = document.querySelectorAll('.likert-option');
            options.forEach(opt => {
                opt.className = 'likert-option';
            });
            options[value - 1].classList.add('selected', `selected-${value}`);

            document.getElementById('nextBtn').disabled = false;
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function nextQuestion() {
            if (answers[currentQuestion] === null) return;

            if (currentQuestion < shuffledStatements.length - 1) {
                currentQuestion++;
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('questionScreen').classList.remove('active');
            document.getElementById('processingScreen').classList.add('active');
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('progressText').style.display = 'none';

            setTimeout(calculateResults, 1500);
        }

        function calculateResults() {
            // Calculate scores per competency
            // For each competency, we have 4 statements, each scored 1-5
            // Reverse items: 1→5, 2→4, 3→3, 4→2, 5→1
            // Final score per competency = average of 4 items, normalized to 0-100%

            const scores = {};
            const counts = {};

            Object.keys(competencies).forEach(c => {
                scores[c] = 0;
                counts[c] = 0;
            });

            shuffledStatements.forEach((statement, index) => {
                let score = answers[index];
                if (score === null) return;

                // Apply reverse scoring if needed
                if (statement.reverse) {
                    score = 6 - score; // 1→5, 2→4, 3→3, 4→2, 5→1
                }

                scores[statement.comp] += score;
                counts[statement.comp]++;
            });

            // Calculate percentage for each competency
            // Each competency has 4 items, each scored 1-5
            // Min total = 4, Max total = 20
            // Normalize to 0-100%
            const results = Object.entries(scores).map(([key, total]) => {
                const count = counts[key];
                if (count === 0) return { key, percentage: 0 };

                const average = total / count; // Will be 1-5
                // Convert 1-5 scale to 0-100%
                const percentage = Math.round(((average - 1) / 4) * 100);

                return {
                    key,
                    score: total,
                    count,
                    average: average.toFixed(2),
                    percentage
                };
            }).sort((a, b) => b.percentage - a.percentage);

            // Render results
            document.getElementById('processingScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');

            const topContainer = document.getElementById('topResults');
            const allContainer = document.getElementById('allResults');

            topContainer.innerHTML = results.slice(0, 5).map((item, i) => renderResultItem(item, i + 1)).join('');
            allContainer.innerHTML = results.slice(5).map((item, i) => renderResultItem(item, i + 6)).join('');

            window.assessmentResults = results;
        }

        function renderResultItem(item, rank) {
            const comp = competencies[item.key];

            // Determine score bar color based on percentage
            let barColor;
            if (item.percentage >= 70) {
                barColor = 'linear-gradient(90deg, #10B981, #059669)';
            } else if (item.percentage >= 40) {
                barColor = 'linear-gradient(90deg, #EAB308, #CA8A04)';
            } else {
                barColor = 'linear-gradient(90deg, #EF4444, #DC2626)';
            }

            return `
                <div class="result-item">
                    <div class="result-header">
                        <div class="result-rank">${rank}</div>
                        <div class="result-name">${comp.name}</div>
                        <div class="result-score">${item.percentage}%</div>
                    </div>
                    <div class="score-bar-container">
                        <div class="score-bar" style="width: ${item.percentage}%; background: ${barColor}"></div>
                    </div>
                    <div class="result-description">${comp.definition}</div>
                </div>
            `;
        }

        function toggleAllResults() {
            const container = document.getElementById('allResults');
            const btn = document.getElementById('showAllBtn');
            container.classList.toggle('show');
            btn.textContent = container.classList.contains('show')
                ? 'Verberg overige competenties'
                : 'Toon alle 11 competenties';
        }

        function copyResults() {
            if (!window.assessmentResults) return;

            let text = "Mijn Competentie Profiel\n";
            text += "========================\n\n";

            window.assessmentResults.forEach((item, i) => {
                const comp = competencies[item.key];
                const level = item.percentage >= 70 ? "Sterk" : item.percentage >= 40 ? "Gemiddeld" : "Ontwikkelpunt";
                text += `${i + 1}. ${comp.name} - ${item.percentage}% (${level})\n`;
                text += `   ${comp.definition}\n\n`;
            });

            navigator.clipboard.writeText(text).then(() => {
                showToast('Gekopieerd naar klembord');
            });
        }

        function downloadResults() {
            if (!window.assessmentResults) return;

            const results = window.assessmentResults;
            const html = `<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Competentie Profiel</title>
<style>
body{font-family:Arial,sans-serif;max-width:700px;margin:40px auto;padding:20px;color:#333}
h1{color:#4F46E5;border-bottom:2px solid #4F46E5;padding-bottom:10px}
.legend{background:#f8fafc;padding:12px 16px;border-radius:8px;margin-bottom:24px;font-size:13px}
.legend span{margin-right:16px}
.high{color:#10B981}
.medium{color:#EAB308}
.low{color:#EF4444}
.item{margin:20px 0;padding:15px;background:#f8fafc;border-left:4px solid #4F46E5;border-radius:0 8px 8px 0}
.item.high{border-left-color:#10B981}
.item.medium{border-left-color:#EAB308}
.item.low{border-left-color:#EF4444}
.item h3{margin:0 0 8px 0;display:flex;align-items:center;gap:10px}
.rank{background:#4F46E5;color:white;width:24px;height:24px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-size:12px}
.score{margin-left:auto;font-weight:bold}
.bar{background:#e2e8f0;height:6px;border-radius:3px;margin:10px 0}
.bar-fill{height:100%;border-radius:3px}
.bar-fill.high{background:#10B981}
.bar-fill.medium{background:#EAB308}
.bar-fill.low{background:#EF4444}
p{margin:0;color:#64748b;font-size:14px}
.date{color:#94a3b8;font-size:12px;margin-top:30px}
</style></head><body>
<h1>Competentie Profiel</h1>
<div class="legend">
<span class="high">● 70-100%: Sterk ontwikkeld</span>
<span class="medium">● 40-69%: Gemiddeld</span>
<span class="low">● 0-39%: Ontwikkelpunt</span>
</div>
${results.map((item, i) => {
    const level = item.percentage >= 70 ? 'high' : item.percentage >= 40 ? 'medium' : 'low';
    return `
<div class="item ${level}">
<h3><span class="rank">${i+1}</span>${competencies[item.key].name}<span class="score ${level}">${item.percentage}%</span></h3>
<div class="bar"><div class="bar-fill ${level}" style="width:${item.percentage}%"></div></div>
<p>${competencies[item.key].definition}</p>
</div>`;
}).join('')}
<p class="date">Gegenereerd op ${new Date().toLocaleDateString('nl-NL')}</p>
</body></html>`;

            const win = window.open('', '_blank');
            win.document.write(html);
            win.document.close();
            showToast('PDF venster geopend - Ctrl/Cmd+P om te printen');
        }

        function restartAssessment() {
            document.getElementById('resultsScreen').classList.remove('active');
            document.getElementById('introScreen').classList.add('active');
            document.getElementById('allResults').classList.remove('show');
            document.getElementById('showAllBtn').textContent = 'Toon alle 11 competenties';
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }
    </script>
</body>
</html>
